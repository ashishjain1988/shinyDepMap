```{r child_summary_efficacy_selectivity, context="server"}
output$summary_efficacy_selectivity <- renderPlotly({
	gen.path2 <- igenclust2() 
	eid2 <- ieid2() 
	path2 <- ipath2() 
	clust2 <- iclust2()
	color2 <- icolor2() #c("gene,pathway","cluster","efficacy","selectivity"),
	lik2 <- ilik2()

	gs2 <- igs2()

	if(is.null(gen.path2)|
		(gen.path2=="gene"&is.null(eid2))|
		(gen.path2=="pathway"&is.null(path2))|
		(gen.path2=="cluster"&is.null(clust2)))
	return(NULL)

	if(gen.path2=="gene"){
		eids <- eid2
	}else if(gen.path2=="pathway"){
		eids <- gs2
	}else if(gen.path2=="cluster"){
		eids <- mems$eid[mems$mem==clust2]
	}

	if(color2 %in% c("density")){
		df.1 <- df.1 %>% arrange(d) %>% mutate(pri=d)
		col <- scale_color_identity()
	}else if(color2=="efficacy"){
		df.1 <- df.1 %>% arrange(desc(efficacy)) %>% mutate(pri=-efficacy)
		col <- scale_colour_gradientn(colours = rev(brewer.pal(11,"Spectral")))
	}else if(color2=="selectivity"){
		df.1 <- df.1 %>% arrange(selectivity) %>% mutate(pri=selectivity)
		col <- scale_colour_gradientn(colours = rev(brewer.pal(11,"Spectral")))
	}

	p <- ggplot(df,aes(text=text)) +
		geom_vline(xintercept=thres.eff) +
		geom_point(data=(df.0),aes(efficacy, selectivity), col="grey80", alpha=.5,size = .3) +
		geom_point(data=(df.1 %>% filter(!eid %in% eids) %>% filter(lik < lik2)),
			aes(efficacy,selectivity),col="grey80",alpha=.5,size = .3) +
		geom_point(data=(df.1 %>% filter(!eid %in% eids) %>% filter(lik >= lik2)),
			aes(efficacy, selectivity, col=pri), size = .5) +
		col +
		geom_point(data=(df.1 %>% filter(eid %in% eids) %>% filter(lik < lik2)),
			aes(efficacy,selectivity),col="grey50",size=1) +
		geom_point(data=(df.1 %>% filter(eid %in% eids) %>% filter(lik >= lik2)),
			aes(efficacy,selectivity),col="red",size=1) +
		theme_bw() +
		# xlim(xl[1],xl[2]) +
		# ylim(yl[1],yl[2]) +
	    theme(legend.position="none",plot.margin=unit(c(0,0,0,0),"lines"),
	      axis.text=element_text(size=10),axis.title=element_text(size=10),
	      plot.title=element_text(size=10),
	      axis.text.x = element_text(angle = 0))
	ply <- ggplotly(p,tooltip="text")
	ply
})
```
```{r}
plotlyOutput('summary_efficacy_selectivity')
```
