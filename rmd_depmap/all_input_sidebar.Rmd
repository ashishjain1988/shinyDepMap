```{r child_sidebar1}
## choose genes
textInput(
	inputId = "sym.query",
	label = h4("Gene:"),
  value = "",
  placeholder="A full or partial gene name")
actionButton("goButton", "Go")

HTML("<hr>")
uiOutput("gene_subset")

```

```{r child_reactive1, context="server"}
igo <- reactive(input$goButton)
isym.query <- reactive(input$sym.query)

output$gene_subset <- renderUI({ ## in response to symbol, get the probe
  go <- igo()
  sym.query <- toupper(isolate(isym.query()))
  this.df <- df %>% 
    filter(grepl(paste0("^",sym.query),df$sym,ignore.case=T)) %>%
    arrange(efficacy)

  if(any(this.df$sym==sym.query)){
    idx <- which(this.df$sym==sym.query)
    ri <- c(idx,seq(nrow(this.df))[-idx])
    this.df <- this.df[ri,]
    # stop(paste(c(idx,ri,collapse=",")))
  }

  # stop(paste(c(sym.query,this.df$sym),collapse=","))
  this.set <- this.df$sym
  
  if(sym.query==""){
    return(NULL)
  }else{
    pickerInput(
      inputId = "sym1",
      label = h5("Choose one gene:"),
      choices = this.set,
      options = list(`live-search` = TRUE))
  }
})

isym1 <- reactive(input$sym1)

ief1 <- reactive({
  sym1 <- input$sym1
  eids <- df$eid[df$sym==toupper(sym1)]
  if(length(eids)==1){
    s3readRDS(paste0("scores_all_19q3/",eids,".rds"),bucket="depmap")
  }else{
    NULL
  }
})
```
