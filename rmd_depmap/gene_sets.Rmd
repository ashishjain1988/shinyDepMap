```{r child_gene_sets, context="server"}
output$gene_sets <- renderDT({
	gen.path2 <- igenclust2()
	eid2 <- ieid2() 
	path2 <- ipath2() 
	clust2 <- iclust2()
	lik2 <- ilik2()
	gs2 <- igs2()

	if(gen.path2=="gene"){
		eids <- eid2
	}else if(gen.path2=="pathway"){
		eids <- gs2
	}else if(gen.path2=="cluster"){
		eids <- mems$eid[mems$mem==clust2]
	}

	if(!any(mems$eid %in% eids)){
		return(NULL)
	}else{
		dt <- mems %>% filter(eid %in% eids) %>%
			select(sym.all, efficacy, selectivity, mem, lik) %>%
			`colnames<-`(c("symbol (EntrezID)","eff","sele","cluster","likelihood"))

		inds <- which(dt$likelihood >= lik2)
		dt <- dt %>%
			datatable(extensions = 'Scroller', 
				options = list(
	　　			  rowReorder = TRUE,
				  deferRender = TRUE,
				  scrollY = 1000,
				  pageLength = 200,
				  scroller = TRUE,
				  order = list(list(2, 'asc'), list(3, 'desc'))),
				selection=list(mode="multiple", selected=inds,target="row"),
				editable=FALSE)
		return(dt)
	}
})
```
```{r}
DTOutput("gene_sets")
```
